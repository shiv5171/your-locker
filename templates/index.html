<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Your Locker</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Icons + Fonts -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="bg-gray-100 font-poppins">

  <!-- Top Navigation Buttons -->
  <div class="w-full flex flex-wrap justify-center gap-3 mt-5 px-4">
    <a href="/" class="inline-flex items-center px-5 py-2.5 bg-gradient-to-r from-green-500 to-teal-600 text-white font-semibold rounded-lg shadow-md hover:from-teal-600 hover:to-green-500 transform hover:-translate-y-0.5 hover:shadow-lg transition-all duration-300 ease-in-out">
      <i class="fas fa-home mr-2"></i> Home
    </a>
    <a href="/login" class="inline-flex items-center px-5 py-2.5 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-semibold rounded-lg shadow-md hover:from-purple-600 hover:to-indigo-500 transform hover:-translate-y-0.5 hover:shadow-lg transition-all duration-300 ease-in-out">
      <i class="fas fa-user-shield mr-2"></i> User Login
    </a>
    <a href="/about" class="inline-flex items-center px-5 py-2.5 bg-gradient-to-r from-pink-500 to-red-600 text-white font-semibold rounded-lg shadow-md hover:from-red-600 hover:to-pink-500 transform hover:-translate-y-0.5 hover:shadow-lg transition-all duration-300 ease-in-out">
      <i class="fas fa-info-circle mr-2"></i> About
    </a>
  </div>

  <!-- Booking Form -->
  <form id="bookingForm" method="POST" action="/book" class="max-w-xl mx-auto bg-white p-6 mt-6 rounded-lg shadow-lg">
    <h1 class="text-2xl font-bold mb-4">üöâ Your Locker</h1>

    <label>City <span class="hindi">‡§∂‡§π‡§∞</span></label>
    <select id="city" name="city" required onchange="updateStationTypes()" class="w-full mb-3 p-2 border rounded">
      <option value="">Select City</option>
      <option value="Delhi">Delhi</option>
      <option value="Meerut">Meerut</option>
      <option value="Lucknow">Lucknow</option>
    </select>

    <label>Station Type <span class="hindi">‡§∏‡•ç‡§ü‡•á‡§∂‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</span></label>
    <select id="stationType" name="stationType" required onchange="updateStations()" class="w-full mb-3 p-2 border rounded">
      <option value="">Select Type</option>
      <option value="Railway">Railway Station</option>
      <option value="Bus">Bus Station</option>
    </select>

    <label>Station <span class="hindi">‡§∏‡•ç‡§ü‡•á‡§∂‡§®</span></label>
    <select id="station" name="station" required class="w-full mb-3 p-2 border rounded">
      <option value="">Select Station</option>
    </select>

   
    <label>Day <span class="hindi">‡§¶‡§ø‡§®</span></label>
    <select name="day" required class="w-full mb-3 p-2 border rounded">
      <option value="monday">Monday</option>
      <option value="tuesday">Tuesday</option>
      <option value="wednesday">Wednesday</option>
      <option value="thursday">Thursday</option>
      <option value="friday">Friday</option>
      <option value="saturday">Saturday</option>
      <option value="sunday">Sunday</option>
    </select>

    <label>Date <span class="hindi">‡§§‡§æ‡§∞‡•Ä‡§ñ</span></label>
    <input type="date" name="date" required class="w-full mb-3 p-2 border rounded" />

    <label>Duration <span class="hindi">‡§Ö‡§µ‡§ß‡§ø</span></label>
    <select id="days" name="days" required class="w-full mb-3 p-2 border rounded">
      <option value="1">1 Day ‚Äì ‚Çπ50</option>
      <option value="2">2 Days ‚Äì ‚Çπ100</option>
      <option value="3">3 Days ‚Äì ‚Çπ150</option>
      <option value="4">4 Days ‚Äì ‚Çπ200</option>
    </select>

    <p id="priceDisplay" class="font-semibold mb-3">üí∞ Price: ‚Çπ50</p>

    <label>Your Name <span class="hindi">‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ</span></label>
    <input type="text" name="name" required class="w-full mb-3 p-2 border rounded" />

    <label>Mobile No <span class="hindi">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞</span></label>
    <input type="tel" name="mobile" required pattern="[0-9]{10}" class="w-full mb-3 p-2 border rounded" />

    <label>Choose Slot <span class="hindi">‡§∏‡•ç‡§≤‡•â‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç</span></label>
    <div id="slotContainer" class="slot-grid mb-3"></div>
    <input type="hidden" name="slot" id="slotInput" required>

    

    <!-- Form Action Buttons -->
    <div class="flex flex-wrap gap-3 justify-center mt-4">
      <button type="submit" class="px-5 py-2.5 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-semibold rounded-lg shadow-md hover:from-purple-600 hover:to-indigo-500 transform hover:-translate-y-0.5 hover:shadow-lg transition-all duration-300 ease-in-out">
        üöÄ Book Locker
      </button>
     
      </button>
      <a href="/" class="px-5 py-2.5 bg-red-500 text-white rounded-lg shadow-md hover:bg-red-600 transition">
        <i class="fas fa-times mr-1"></i> Cancel
      </a>
    </div>
  </form>

  <!-- Social Links -->
  <ul class="social-list flex justify-center gap-4 mt-6">
    <li><a href="https://www.facebook.com/satyam.verma.984349"><i class="fab fa-facebook-f icon"></i></a></li>
    <li><a href="https://x.com/ShivVerma532824"><i class="fab fa-twitter icon"></i></a></li>
    <li><a href="https://www.linkedin.com/in/shiv-verma-procoder"><i class="fab fa-linkedin-in icon"></i></a></li>
    <li><a href="https://www.instagram.com/satyam_verma_7675"><i class="fab fa-instagram icon insta-icon"></i></a></li>
  </ul>

  <script>
    const stations = {
      Delhi: {
        Railway: ["New Delhi", "Hazrat Nizamuddin", "Anand Vihar"],
        Bus: ["ISBT Kashmere Gate", "ISBT Sarai Kale Khan"]
      },
            Meerut: {
        Railway: ["Meerut City", "Meerut Cantt"],
        Bus: ["ISBT Meerut", "Bhainsali Bus Stand"]
      },
      Lucknow: {
        Railway: ["Charbagh", "Lucknow Junction"],
        Bus: ["Alambagh", "Kaiserbagh"]
      }
    };

    function updateStationTypes() {
      document.getElementById("stationType").value = "";
      document.getElementById("station").innerHTML = `<option value="">Select Station</option>`;
      clearSlots();
    }

    function updateStations() {
      const city = document.getElementById("city").value;
      const type = document.getElementById("stationType").value;
      const stationSelect = document.getElementById("station");

      stationSelect.innerHTML = `<option value="">Select Station</option>`;
      clearSlots();
      if (city && type && stations[city] && stations[city][type]) {
        stations[city][type].forEach(station => {
          const option = document.createElement("option");
          option.value = station;
          option.textContent = station;
          stationSelect.appendChild(option);
        });
      }
    }

    function clearSlots() {
      document.getElementById("slotContainer").innerHTML = "";
      document.getElementById("slotInput").value = "";
    }

    function updateSlots() {
      const station = document.getElementById("station").value;
      clearSlots();
      if (!station) return;

      fetch("/get_slots", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ station })
      })
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById("slotContainer");
        const slots = data.available_slots || [];
        if (slots.length === 0) {
          container.innerHTML = `<div class="slot-empty text-red-500 font-semibold">No slots available for this station</div>`;
          return;
        }
        slots.forEach(slot => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "slot-btn px-3 py-1 m-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition";
          btn.textContent = `Slot ${slot}`;
          btn.onclick = () => {
            document.querySelectorAll("#slotContainer .slot-btn").forEach(b => b.classList.remove("active", "bg-blue-700"));
            btn.classList.add("active", "bg-blue-700");
            document.getElementById("slotInput").value = slot;
          };
          container.appendChild(btn);
        });
      })
      .catch(() => {
        const container = document.getElementById("slotContainer");
        container.innerHTML = `<div class="slot-empty text-red-500 font-semibold">Error loading slots</div>`;
      });
    }

    document.getElementById('days').addEventListener('change', function() {
      const days = parseInt(this.value || "1");
      document.getElementById('priceDisplay').textContent = `üí∞ Price: ‚Çπ${days * 50}`;
    });

    document.getElementById("station").addEventListener("change", updateSlots);

    document.getElementById("bookingForm").addEventListener("submit", function(e) {
      const slotVal = document.getElementById("slotInput").value;
      if (!slotVal) {
        e.preventDefault();
        alert("Please select a slot before booking.\n‡§ï‡•É‡§™‡§Ø‡§æ ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§∏‡•ç‡§≤‡•â‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç‡•§");
      }
    });
  </script>
</body>
</html>
